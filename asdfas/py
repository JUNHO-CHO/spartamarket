class ProductCreateView(APIView):
    permission_classes = [IsAuthenticated]

    def post(self, request):
        serializer = ProductSerializer(data=request.data, context={'request': request})
        if serializer.is_valid():
            serializer.save()  # 이때 create 메서드가 호출됨
            return Response(serializer.data, status=status.HTTP_201_CREATED)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)




from rest_framework import serializers
from .models import Product

class ProductSerializer(serializers.ModelSerializer):
    class Meta:
        model = Product
        fields = '__all__'

    def create(self, validated_data):
        request = self.context.get('request')
        author = request.user if request else None
        product = Product.objects.create(author=author, **validated_data)
        return product



from django.urls import path
from .views import ProductCreateView, ProductListAPIview, ProductDetailAPIView

app_name = 'products'

urlpatterns = [
    path('', ProductListAPIview.as_view(), name='products_list'),
    path('create/', ProductCreateView.as_view(), name='product_create'),  # 상품 생성
    path('<int:pk>/', ProductDetailAPIView.as_view(), name='product_detail'),
]